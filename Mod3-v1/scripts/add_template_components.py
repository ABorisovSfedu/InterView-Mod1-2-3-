#!/usr/bin/env python3
"""–°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤"""

import sqlite3
import os

def add_new_template_components():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤"""
    
    # –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    db_path = os.path.join(os.path.dirname(os.path.dirname(os.path.abspath(__file__))), "mod3.db")
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()
    
    try:
        # –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
        new_components = [
            # Medical clinic –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            ("ui.doctorsList", "ui.doctorsList", "–°–ø–∏—Å–æ–∫ –≤—Ä–∞—á–µ–π", "medical"),
            ("ui.appointmentForm", "ui.appointmentForm", "–§–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–∏—ë–º", "medical"),
            
            # Education portal –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            ("ui.courseList", "ui.courseList", "–°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤", "education"),
            
            # Job board –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            ("ui.jobList", "ui.jobList", "–°–ø–∏—Å–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–π", "job"),
            
            # Event landing –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            ("ui.countdown", "ui.countdown", "–û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç", "event"),
            ("ui.schedule", "ui.schedule", "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π", "event"),
            ("ui.speakers", "ui.speakers", "–°–ø–∏—Å–æ–∫ —Å–ø–∏–∫–µ—Ä–æ–≤", "event"),
            ("ui.tickets", "ui.tickets", "–ë–∏–ª–µ—Ç—ã", "event"),
            ("ui.gallery", "ui.gallery", "–ì–∞–ª–µ—Ä–µ—è", "event"),
            
            # Finance services –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (calculator —É–∂–µ –µ—Å—Ç—å)
            ("ui.contacts", "ui.contacts", "–ö–æ–Ω—Ç–∞–∫—Ç—ã", "contact"),
        ]
        
        for name, component_type, description, category in new_components:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
            cursor.execute("SELECT id FROM components WHERE name = ?", (name,))
            if not cursor.fetchone():
                cursor.execute("""
                    INSERT INTO components (name, component_type, description, category, is_active, created_at, updated_at)
                    VALUES (?, ?, ?, ?, 1, datetime('now'), datetime('now'))
                """, (name, component_type, description, category))
                print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: {name}")
            else:
                print(f"‚ö†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç {name} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
        
        print("‚úÖ –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã")
        
        # –ù–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
        new_terms = [
            # Medical clinic —Ç–µ—Ä–º–∏–Ω—ã
            ("–∫–ª–∏–Ω–∏–∫–∞", ["–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–ª–∏–Ω–∏–∫–∞", "–ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞", "–±–æ–ª—å–Ω–∏—Ü–∞"], "ui.servicesGrid"),
            ("–≤—Ä–∞—á", ["–¥–æ–∫—Ç–æ—Ä", "–º–µ–¥–∏–∫", "—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"], "ui.doctorsList"),
            ("–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä", ["–º–µ–¥—Ü–µ–Ω—Ç—Ä", "–∫–ª–∏–Ω–∏–∫–∞", "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ"], "ui.servicesGrid"),
            ("–∑–∞–ø–∏—Å—å", ["–∑–∞–ø–∏—Å–∞—Ç—å—Å—è", "–∑–∞–ø–∏—Å—å –Ω–∞ –ø—Ä–∏—ë–º", "–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ"], "ui.appointmentForm"),
            ("–ø—Ä–∏—ë–º", ["–ø—Ä–∏—ë–º –≤—Ä–∞—á–∞", "–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", "–æ—Å–º–æ—Ç—Ä"], "ui.appointmentForm"),
            ("–ª–µ—á–µ–Ω–∏–µ", ["—Ç–µ—Ä–∞–ø–∏—è", "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø–æ–º–æ—â—å", "–æ–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏–µ"], "ui.servicesGrid"),
            ("–∞–Ω–∞–ª–∏–∑—ã", ["–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∞–Ω–∞–ª–∏–∑—ã", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"], "ui.servicesGrid"),
            ("–∑–¥–æ—Ä–æ–≤—å–µ", ["–º–µ–¥–∏—Ü–∏–Ω–∞", "–∑–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏", "–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞"], "ui.servicesGrid"),
            
            # Education portal —Ç–µ—Ä–º–∏–Ω—ã
            ("–æ–±—É—á–µ–Ω–∏–µ", ["–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ", "—É—á—ë–±–∞", "—Ä–∞–∑–≤–∏—Ç–∏–µ"], "ui.courseList"),
            ("–∫—É—Ä—Å", ["–ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±—É—á–µ–Ω–∏—è", "—É—á–µ–±–Ω—ã–π –∫—É—Ä—Å", "–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞"], "ui.courseList"),
            ("–ø—Ä–æ–≥—Ä–∞–º–º–∞", ["—É—á–µ–±–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞", "–∫—É—Ä—Å –æ–±—É—á–µ–Ω–∏—è", "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"], "ui.courseList"),
            ("–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å", ["—É—á–∏—Ç–µ–ª—å", "–∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä", "—Ç—Ä–µ–Ω–µ—Ä"], "ui.featuresList"),
            ("—É—Ä–æ–∫", ["–∑–∞–Ω—è—Ç–∏–µ", "–ª–µ–∫—Ü–∏—è", "—Å–µ–º–∏–Ω–∞—Ä"], "ui.courseList"),
            ("—à–∫–æ–ª–∞", ["—É—á–µ–±–Ω–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ", "–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ"], "ui.featuresList"),
            ("—Å—Ç—É–¥–µ–Ω—Ç—ã", ["—É—á–∞—â–∏–µ—Å—è", "–æ–±—É—á–∞—é—â–∏–µ—Å—è", "—Å–ª—É—à–∞—Ç–µ–ª–∏"], "ui.testimonials"),
            
            # Job board —Ç–µ—Ä–º–∏–Ω—ã
            ("—Ä–∞–±–æ—Ç–∞", ["—Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", "–∑–∞–Ω—è—Ç–æ—Å—Ç—å", "–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å"], "ui.jobList"),
            ("–≤–∞–∫–∞–Ω—Å–∏–∏", ["–æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏", "—Ç—Ä—É–¥–æ–≤—ã–µ –º–µ—Å—Ç–∞", "–¥–æ–ª–∂–Ω–æ—Å—Ç–∏"], "ui.jobList"),
            ("–∫–∞—Ä—å–µ—Ä–∞", ["–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç", "—Ä–∞–∑–≤–∏—Ç–∏–µ –∫–∞—Ä—å–µ—Ä—ã"], "ui.jobList"),
            ("—Ä–µ–∑—é–º–µ", ["CV", "–∞–Ω–∫–µ—Ç–∞", "–ø—Ä–æ—Ñ–∏–ª—å"], "ui.form"),
            ("–æ—Ç–∫–ª–∏–∫", ["–æ—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è", "–ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É", "–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ"], "ui.button"),
            ("–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç—ã", ["–ø–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π", "—Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ"], "ui.search"),
            
            # Event landing —Ç–µ—Ä–º–∏–Ω—ã
            ("–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ", ["—Å–æ–±—ã—Ç–∏–µ", "–∞–∫—Ü–∏—è", "–≤—Å—Ç—Ä–µ—á–∞"], "ui.schedule"),
            ("—Å–æ–±—ã—Ç–∏–µ", ["–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ", "–∞–∫—Ü–∏—è", "–≤—Å—Ç—Ä–µ—á–∞"], "ui.schedule"),
            ("–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è", ["—Å–∏–º–ø–æ–∑–∏—É–º", "—Ñ–æ—Ä—É–º", "—Å—ä–µ–∑–¥"], "ui.schedule"),
            ("—Ñ–µ—Å—Ç–∏–≤–∞–ª—å", ["–ø—Ä–∞–∑–¥–Ω–∏–∫", "—Ñ–µ—Å—Ç", "–ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ"], "ui.schedule"),
            ("—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è", ["–∑–∞–ø–∏—Å—å", "—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è", "—É—á–∞—Å—Ç–∏–µ"], "ui.form"),
            ("–±–∏–ª–µ—Ç—ã", ["–≤—Ö–æ–¥–Ω—ã–µ –±–∏–ª–µ—Ç—ã", "–ø—Ä–æ–ø—É—Å–∫–∏", "–≤—Ö–æ–¥"], "ui.tickets"),
            ("—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ", ["–ø—Ä–æ–≥—Ä–∞–º–º–∞", "–ø–ª–∞–Ω", "–≥—Ä–∞—Ñ–∏–∫"], "ui.schedule"),
            
            # Finance services —Ç–µ—Ä–º–∏–Ω—ã
            ("–±–∞–Ω–∫", ["–±–∞–Ω–∫–æ–≤—Å–∫–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ", "—Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ"], "ui.servicesGrid"),
            ("–∫—Ä–µ–¥–∏—Ç", ["–∑–∞–π–º", "—Å—Å—É–¥–∞", "–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏–µ"], "ui.servicesGrid"),
            ("–∏–ø–æ—Ç–µ–∫–∞", ["–∏–ø–æ—Ç–µ—á–Ω–æ–µ –∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏–µ", "–∂–∏–ª–∏—â–Ω—ã–π –∫—Ä–µ–¥–∏—Ç"], "ui.servicesGrid"),
            ("–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", ["–≤–ª–æ–∂–µ–Ω–∏—è", "–∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ", "–∫–∞–ø–∏—Ç–∞–ª–æ–≤–ª–æ–∂–µ–Ω–∏—è"], "ui.servicesGrid"),
            ("—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞", ["—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ", "—Å—Ç—Ä–∞—Ö–æ–≤–æ–π –ø–æ–ª–∏—Å"], "ui.servicesGrid"),
            ("—Ñ–∏–Ω–∞–Ω—Å—ã", ["–¥–µ–Ω–µ–∂–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞", "—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏"], "ui.servicesGrid"),
            ("–ø—Ä–æ—Ü–µ–Ω—Ç—ã", ["–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞", "–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å"], "ui.calculator"),
            ("–∑–∞—è–≤–∫–∞", ["–∑–∞—è–≤–ª–µ–Ω–∏–µ", "–ø–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏", "–æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ"], "ui.form"),
        ]
        
        for term_name, synonyms, component_name in new_terms:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–µ—Ä–º–∏–Ω
            cursor.execute("SELECT id FROM terms WHERE term = ?", (term_name,))
            existing_term = cursor.fetchone()
            
            if existing_term:
                print(f"‚ö†Ô∏è –¢–µ—Ä–º–∏–Ω '{term_name}' —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
                continue
            
            # –°–æ–∑–¥–∞–µ–º —Ç–µ—Ä–º–∏–Ω
            cursor.execute("""
                INSERT INTO terms (term, description, is_active, created_at, updated_at)
                VALUES (?, ?, 1, datetime('now'), datetime('now'))
            """, (term_name, f"–¢–µ—Ä–º–∏–Ω –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ {component_name}"))
            
            term_id = cursor.lastrowid
            
            # –°–æ–∑–¥–∞–µ–º —Å–∏–Ω–æ–Ω–∏–º—ã
            for synonym_name in synonyms:
                cursor.execute("""
                    INSERT INTO synonyms (term_id, synonym, created_at, updated_at)
                    VALUES (?, ?, datetime('now'), datetime('now'))
                """, (term_id, synonym_name))
            
            # –°–æ–∑–¥–∞–µ–º –º–∞–ø–ø–∏–Ω–≥ —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º
            cursor.execute("SELECT id FROM components WHERE name = ?", (component_name,))
            component_result = cursor.fetchone()
            if component_result:
                component_id = component_result[0]
                cursor.execute("""
                    INSERT INTO mappings (term_id, component_id, confidence, created_at, updated_at)
                    VALUES (?, ?, 1.0, datetime('now'), datetime('now'))
                """, (term_id, component_id))
                print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Ä–º–∏–Ω: {term_name} ‚Üí {component_name}")
            else:
                print(f"‚ö†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç {component_name} –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞ {term_name}")
        
        conn.commit()
        print("‚úÖ –ù–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        cursor.execute("SELECT COUNT(*) FROM terms")
        terms_count = cursor.fetchone()[0]
        
        cursor.execute("SELECT COUNT(*) FROM components")
        components_count = cursor.fetchone()[0]
        
        cursor.execute("SELECT COUNT(*) FROM synonyms")
        synonyms_count = cursor.fetchone()[0]
        
        cursor.execute("SELECT COUNT(*) FROM mappings")
        mappings_count = cursor.fetchone()[0]
        
        print(f"üìä –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"  - –¢–µ—Ä–º–∏–Ω–æ–≤: {terms_count}")
        print(f"  - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: {components_count}")
        print(f"  - –°–∏–Ω–æ–Ω–∏–º–æ–≤: {synonyms_count}")
        print(f"  - –ú–∞–ø–ø–∏–Ω–≥–æ–≤: {mappings_count}")
        
    except Exception as e:
        conn.rollback()
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: {e}")
        raise
    finally:
        conn.close()

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤")
    print("")
    
    add_new_template_components()
    
    print("")
    print("‚úÖ –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Ç–µ—Ä–º–∏–Ω—ã —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!")

if __name__ == "__main__":
    main()
